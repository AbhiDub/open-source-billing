function init_fullcalendar(){
    // initialize the calendar...
    var current = 'month' ;
    $('#calendar').fullCalendar({

        contentHeight: 'auto',
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,basicWeek'
        },
        dayClick: function(date, jsEvent, view) {
            $.ajax({
                dataType: 'script',
                type: 'GET',
                data:{date:date.format()},
                url: '/en/logs'
            });
            $('#log_date').val(date.format());
            $('#logs_for').html(date.format());

        },

        viewRender: function( view, element ){
            if( view.name != current){
                current = view.name;
                $.ajax({
                    dataType: 'script',
                    type: 'GET',
                    async: false,
                    data:{view: view.name},
                    url: '/logs/load_view'
                });
                $('#calendar_div').toggleClass('month basicWeek');
            }
            if (view.name == 'basicWeek'){
                var count = 0;
                $('#hours_div_inner input[type=hidden]').each(function (){
                    var now = new Date(view.start);
                    now.setDate(now.getDate() + count);
                    $(this).attr('value',now);
                    count+=1;
                });
            }
            $('#log_date').val($.datepicker.formatDate('yy-mm-dd', new Date()) );
        },
        events: '/logs/events.json'
//        eventClick: function(event) {
//            $('#log_date').val(event.date.format());
//            $('#logs_for').html(event.date.format());
//        }

    });
}

$(document).ready(function() {
    init_fullcalendar();
});
