<div class="reports payments_collected">
  <div class="content_middle">

    <div class="report_content_header">
      <div class="report_content_heading">
        <h1><%= t('views.reports.payments_collected') %></h1>
      </div>

      <div class="content_header_data">
        <div class="header_data_left">
          <div class="header_data_detail">
            <ul>
              <li class="header_name"><%= @report.client_name %></li>
              <li class="header_duration"><%= @report.period %></li>
              <li class="header_description"><%= t('views.reports.payments_collected_dtl') %></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- content_header_data -->
    </div>
    <!-- report_content_header -->

    <%= render 'reports/report_partials/format_links'%>

    <div class="grid_table">
      <table cellpadding="0" cellspacing="0" class="table_listing">
        <colgroup>
          <col class="one"/>
          <col class="two"/>
          <col class="three"/>
          <col class="four"/>
          <col class="five"/>
          <col class="six"/>
        </colgroup>
        <thead>
        <tr>
          <th class="align_left"><%= sortable('invoice_number', 'Invoice') %></th>
          <th class="align_left"><%= t('views.clients.client_name') %></th>
          <th class="align_left"><%= t('views.common.type') %></th>
          <th class="align_left"><%= t('views.common.note') %></th>
          <th class="align_center"><%= t('views.common.date') %></th>
          <th class="align_right {sorter:'thousands'}"><%= t('views.dashboard.amount') %></th>
        </tr>
        </thead>
        <tbody>
        <% unless @report.report_data.blank? %>
            <% @report.report_data.each do |payment| %>
              <% border_class= @report.report_data.last==payment ? 'dark-border' : (payment.border==1 ? 'normal-border' : 'no-border') %>
              <tr>
                <td class="align_left <%= border_class %>" ><%= payment.invoice.invoice_number rescue payment.invoice_number %></td>
                <td class="align_left text-overflow-class <%= border_class %>" data-overflow-rows="2" ><%= payment[:client_name] %></td>
                <td class="align_left <%= border_class %>" ><%= (payment.payment_type || payment.payment_method || "").capitalize %></td>
                <td class="align_left text-overflow-class <%= border_class %>" data-overflow-rows="2" ><%= payment.notes %></td>
                <td class="align_center <%= border_class %>" ><%= payment.created_at.to_date %></td>
                <td class="align_right currency <%= border_class %>" ><%= content_tag(:span, '* ') if payment.payment_method == "Credit" %><%= number_to_currency(payment.payment_amount,unit: payment.currency_code) %></td>
              </tr>
            <% end %>
            <tfoot>
              <% is_first = true %>
              <% @report.report_total.each do |total| %>
                <% border_class= @report.report_total.last==total ? 'dark-border' : 'no-border' %>
                <tr>
                  <td class="align_left <%= border_class %>" ><%= is_first ? t('views.common.total') : '' %></td>
                  <td class="align_left <%= border_class %>"></td>
                  <td class="align_left <%= border_class %>"></td>
                  <td class="align_left <%= border_class %>"></td>
                  <td class="align_left <%= border_class %>"></td>
                  <td class="align_right currency <%= border_class %>"><%= number_to_currency(total[:total],unit: total[:currency_code]) %></td>
                </tr>
                <% is_first = false %>
              <% end %>
            </tfoot>
        <% else %>
            <tr>
              <td colspan="6"><%= t('views.reports.report_no_data') %></td>
            </tr>
        <% end %>
        </tbody>
      </table>
    </div>
    <!--grid_table-->

  </div>
  <!--content_middle-->

  <div class="content_bottom">
    <div class="report_footer">
    </div>
    <!-- report_footer -->
  </div>
  <!--content_bottom-->
</div><!--reports-->